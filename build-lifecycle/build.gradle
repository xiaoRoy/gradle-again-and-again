println 'This is executed during the configuration phase.'


allprojects {
    afterEvaluate { project -> 
        println "$project.name"
    }
}



tasks.register('configured') {
    println 'This is also executed during the configuration phase, because :configured is used in the build.'
}

tasks.register('test') {
    doLast {
        println 'This is executed during the execution phase.'
    }
}

tasks.register('testBoth') {
    doFirst {
	  println 'This is executed first during the execution phase.'
	}
	doLast {
	  println 'This is executed last during the execution phase.'
	}
	println 'This is executed during the configuration phase as well, because :testBoth is used in the build.'
}

tasks.whenTaskAdded { task -> 
    if('displayName' == task.name) {
        println 'displayName task added'
    }
}

tasks.register('displayName') {
    doLast {
        println 'Display Nothing.'
    }
}

tasks.register('first') {
    doLast {
        println 'First Step is completed!'
    }
}

tasks.register('second') {
    dependsOn first
    doLast {
        //simulate failure
        throw new IOException()
    }
}

gradle.taskGraph.beforeTask { task -> 
    def taskNames = ['first', 'second']
    def currentTaskName = task.name
    if(currentTaskName in taskNames) {
        println "Starting task $currentTaskName"
    }
}

gradle.taskGraph.afterTask { task, taskState -> 
    def taskNames = ['first', 'second']
    def currentTaskName = task.name
    if(currentTaskName in taskNames) {
        if(taskState.failure) {
            println 'failed'
        } else {
            println 'successfuly'
        }
    }
}